# ETF Borrow Dashboard

Live at: **https://goldmandrew.github.io/etf-dashboard/**

Real-time IBKR short stock borrow rate monitoring with decay-vs-borrow spread analysis for leveraged and inverse ETFs. Deployed as a static site via GitHub Pages — no server required.

## How It Works

```
┌──────────────────────────────────────────────────────────────┐
│  GoldmanDrew/ls-algo  (daily GitHub Action)                  │
│    etf_screener.py → data/etf_screened_today.csv → git push  │
└────────────────────────────┬─────────────────────────────────┘
                             │  raw.githubusercontent.com
┌────────────────────────────▼─────────────────────────────────┐
│  GoldmanDrew/etf-dashboard  (GitHub Action, 3×/day)          │
│                                                              │
│  scripts/build_data.py:                                      │
│    1. Fetch CSV from ls-algo                                 │
│    2. Fetch IBKR FTP borrow rates (live, if reachable)       │
│    3. Assign buckets (High β / Low β / Inverse)              │
│    4. Compute decay estimates + spreads                      │
│    5. Write data/dashboard_data.json                         │
│    6. Commit + Deploy to GitHub Pages                        │
│                                                              │
│  index.html (React SPA):                                     │
│    Reads dashboard_data.json → renders interactive dashboard │
└──────────────────────────────────────────────────────────────┘
```

## Setup (one-time)

### 1. Enable GitHub Pages

Go to **Settings → Pages** in this repo:
- **Source**: GitHub Actions
- That's it — the workflow handles deployment automatically.

### 2. Push to main

```bash
git add -A && git commit -m "initial dashboard" && git push
```

The `build-and-deploy.yml` Action will run automatically on push, build the data, and deploy. Your site will be live at `https://goldmandrew.github.io/etf-dashboard/` within a few minutes.

## Schedule

The Action runs automatically 3× daily on weekdays:
- **2:30 AM ET** — pre-market
- **11:30 AM ET** — midday
- **4:30 PM ET** — after close

Plus on every push to `main` and via manual trigger (Actions → Run workflow).

## Running Locally

```bash
# Generate the data
pip install pandas numpy requests
python scripts/build_data.py

# Serve the site
python -m http.server 8000
# → open http://localhost:8000
```

## File Structure

```
etf-dashboard/
├── index.html                          # React SPA (single file, no build step)
├── data/
│   ├── dashboard_data.json             # Generated by build script
│   └── etf_screened_today.csv          # Cached copy from ls-algo
├── scripts/
│   └── build_data.py                   # Fetches data, computes analytics, writes JSON
├── .github/workflows/
│   └── build-and-deploy.yml            # Scheduled Action: build + deploy Pages
├── requirements.txt
└── README.md
```

## Bucket Definitions

| Bucket | Rule | Description |
|--------|------|-------------|
| **Bucket 1** | Beta > 1.5 | High-beta leveraged ETFs |
| **Bucket 2** | Beta ≤ 1.5 | Lower-beta leveraged ETFs |
| **Bucket 3** | Curated list | ~32 inverse ETFs (hard-coded in build script) |

## Data Sources

- **Universe**: `GoldmanDrew/ls-algo` → `data/etf_screened_today.csv`
- **Borrow rates**: IBKR public FTP (`ftp2.interactivebrokers.com/usa.txt`) — falls back to CSV if FTP is unreachable from GitHub Actions
- **Decay**: Volatility drag model estimate (plug in real Stahl metrics when price data is available)

## Environment Variables (optional)

| Variable | Default | Description |
|----------|---------|-------------|
| `UNIVERSE_REPO` | `GoldmanDrew/ls-algo` | Source repo for universe CSV |
| `UNIVERSE_BRANCH` | `main` | Branch to fetch from |
| `HIGH_BETA_THRESHOLD` | `1.5` | Beta cutoff for Bucket 1 vs 2 |
| `GITHUB_TOKEN` | (from Actions) | Auto-set in CI; needed locally for private repos |
